I"«<h1 id="htb--reverse-engineering--behind-the-scenes">HTB | Reverse Engineering | behind the scenes:</h1>

<p>This is a challenge considered as very easy challenge, but as long as Iâ€™m just starting learning some reverse engineering, itâ€™s not that easy for me .</p>

<p>So we have our executable file here.</p>

<p>Letâ€™s test that out.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled.png" alt="Untitled" /></p>

<p>Letâ€™s now print text strings embedded in our binary.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%201.png" alt="Untitled" /></p>

<p>Hmmm. Nothing really special other than the fact that thereâ€™s some C functions like strcmp,putsâ€¦</p>

<p>Letâ€™s examine this file with ghidra.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%202.png" alt="Untitled" /></p>

<p>After checking our main function, when clicking <code class="language-plaintext highlighter-rouge">invalidInstructionException()</code> the instruction UD2 seems to be highlighted.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%203.png" alt="Untitled" /></p>

<p>Okay according to intelâ€™s documentation UD2 generates an invalid opcode exception</p>

<p>My assumption is that the code executes fine till it bumps into this instruction and then it exits.</p>

<p>So as you can see thereâ€™s some instructions after UD2 letâ€™s disassemble it.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%204.png" alt="Untitled" /></p>

<p>select it and press <strong>d</strong>.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%205.png" alt="Untitled" /></p>

<p>OK so after that if we could replace all those UD2 with NOP we can pass to next instructions.</p>

<p>Now do that to all those UD2 that exists out there.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%206.png" alt="Untitled" /></p>

<p>ALRIGHT! Weâ€™re almost finished you can see the flag itâ€™s just a concatenation of those strings.</p>

<p><img src="/img/posts/HTB_challenges/behind_the_scenes/Untitled%207.png" alt="Untitled" /></p>

<p>Now export the patched program and execute it,finally you got your flag.</p>
:ET